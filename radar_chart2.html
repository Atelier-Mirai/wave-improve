<!DOCTYPE html>
<html lang="ja"></html>
<head>
  <meta charset="UTF-8" />
  <title>レーダーチャート</title>
  <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.bundle.min.js"></script>
</head>
<body>
  <h1>
    レーダーチャート
  </h1>
  <div>
    <canvas id="myChart"></canvas>
  </div>
  <div>
    <button id="randomizeData">ランダムデータ</button><button id="addDataset">   データセットの追加</button><button id="removeDataset">データセットの削除</button><button id="addData">      データの追加</button><button id="removeData">   データの削除</button>
  </div>
  <script>
    // 色の設定
    const colorSet = {
      red   : 'rgb(255, 99, 132)',
      orange: 'rgb(255, 159, 64)',
      yellow: 'rgb(255, 205, 86)',
      green : 'rgb(75, 192, 192)',
      blue  : 'rgb(54, 162, 235)',
      purple: 'rgb(153, 102, 255)',
      grey  : 'rgb(201, 203, 207)'
    }
    
    // 色のRGB変換
    const color = Chart.helpers.color
    
    // 乱数生成(0～100)
    const rnd100 = () => {
      return Math.round(Math.random() * 100)
    }
    
    // チャートの初期設定
    let config = {
      type: 'radar',
      data: {
        labels: ["月曜", "火曜", "水曜", "木曜", "金曜", "土曜", "日曜"],
        datasets: [
          {
            label: "運動量",
            backgroundColor: color(colorSet.red).alpha(0.5).rgbString(),
            borderColor: colorSet.red,
            pointBackgroundColor: colorSet.red,
            data: [40, 50, 60, 70, 80, 90, 100]
          },
          {
            label: "摂取量",
            backgroundColor: color(colorSet.blue).alpha(0.5).rgbString(),
            borderColor: colorSet.blue,
            pointBackgroundColor: colorSet.blue,
            data: [100, 90, 80, 70, 60, 50, 40]
          }
        ]
      },
      options: {
        animation: false,
        showTooltips: false,
        legend: { position: 'bottom' },
        title: {
          display: true,
          fontSize: 20,
          fontColor:'#666',
          text: '一週間チャート'
        },
        scale: {
          display: true,
          pointLabels: {
            fontSize: 15,
            fontColor: colorSet.yellow
          },
          ticks: {
            display: true,
            fontSize: 12,
            fontColor: colorSet.green,
            min: 0,
            max: 100,
            beginAtZero: true
          },
          gridLines: {
            display: true,
            color: colorSet.yellow
          }
        }
      }
    }
    
    // チャートの作成
    let myRadar = new Chart($("#myChart"), config)
    
    // ランダムデータ（#randomizeData）
    $("#randomizeData").on('click', () => {
      alert('aa')
      config.data.datasets.forEach((dataset) => {
        dataset.data = dataset.data.map(() => {
          return rnd100()
        })
      })
      myRadar.update()
    })
    
    let colorNames = Object.keys(colorSet);
    
    // データセットの追加（#addDataset）
    $("#addDataset").on('click', () => {
      let colorName = colorNames[config.data.datasets.length % colorNames.length]
      let newColor = colorSet[colorName]
    
      let newDataset = {
        label: 'Dataset ' + config.data.datasets.length,
        borderColor: newColor,
        backgroundColor: color(newColor).alpha(0.2).rgbString(),
        pointBorderColor: newColor,
        data: [],
      }
    
      for (let index = 0; index < config.data.labels.length; ++index) {
        newDataset.data.push(rnd100())
      }
    
      config.data.datasets.push(newDataset)
      myRadar.update()
    })
    
    // データの追加（#addData）
    $("#addData").on('click', () => {
      if (config.data.datasets.length > 0){
        config.data.labels.push('dataset #' + config.data.labels.length)
    
        config.data.datasets.forEach(function(dataset){
          dataset.data.push(rnd100())
        })
    
        myRadar.update();
      }
    })
    
    // データセットの削除（#removeDataset）
    $("#removeDataset").on('click', () => {
      config.data.datasets.splice(0, 1)
      myRadar.update()
    })
    
    // データの削除（#removeData）
    $("#removeData").on('click', () => {
      config.data.labels.pop() // remove the label first
    
      config.data.datasets.forEach((dataset) => {
        dataset.data.pop()
      })
    
      myRadar.update()
    })
  </script>
  <h1>
    ラーメン用
  </h1>
  <div>
    <canvas id="ramenChart1"></canvas>
  </div>
  <script>
    // 上と重複するので、一旦コメントアウト
    // 色の設定
    // const colorSet = {
    //   red   : 'rgb(255, 99, 132)',
    //   orange: 'rgb(255, 159, 64)',
    //   yellow: 'rgb(255, 205, 86)',
    //   green : 'rgb(75, 192, 192)',
    //   blue  : 'rgb(54, 162, 235)',
    //   purple: 'rgb(153, 102, 255)',
    //   grey  : 'rgb(201, 203, 207)'
    // }
    //
    // // 色のRGB変換
    // const color = Chart.helpers.color
    
    let ramen_data1 = {
      type: 'radar',
      data: {
        labels: ["味", "量", "価格", "速さ", "場所"],
        datasets: [
          {
            label: "平均",
            backgroundColor: color(colorSet.red).alpha(0.5).rgbString(),
            borderColor: colorSet.red,
            pointBackgroundColor: colorSet.red,
            data: [50, 50, 50, 50, 50]
          },
          {
            label: "評価",
            backgroundColor: color(colorSet.blue).alpha(0.5).rgbString(),
            borderColor: colorSet.blue,
            pointBackgroundColor: colorSet.blue,
            data: [60, 90, 80, 70, 30]
          }
        ]
      },
      options: {
        animation: false,
        showTooltips: false,
        legend: { position: 'bottom' },
        title: {
          display: true,
          fontSize: 20,
          fontColor:'#666',
          text: '評価'
        }
      }
    }
    
    // チャートの作成
    new Chart($("#ramenChart1"), ramen_data1)
  </script>
  <h1>
    参考
  </h1>
  <ol>
    <li>
      <a href="https://www.chartjs.org">Chart.js</a>
    </li>
    <li>
      <a href="http://www.chaordic.co.jp/memorandum/2017/08/chartjs.html">Chart.jsでレーダーチャートをつくる</a>
    </li>
  </ol>
</body>
